<!--
 * @Descripttion: 
 * @Author: zlj
 * @Date: 2020-06-11 14:10:44
--> 
# Cookie

## è®¾ç½®/æ¸…é™¤cookie

```.bash
æ ¹æ®cookieçš„nameåç§°,è·å–å¯¹åº”cookieçš„valueå€¼:
cy.getCookie('name')

è·å–æµè§ˆå™¨å…¨éƒ¨cookies
cy.getCookies()

æ·»åŠ cookies
cy.setCookie('name','value')

æ ¹æ®nameåç§°åˆ é™¤æŒ‡å®šcookies
cy.clearCookie('name') 

æ¸…ç©ºå…¨éƒ¨cookie
cy.clearCookies()
```

```.bash
æ —å­ğŸŒ°

cy.getCookies().should('be.empty')

cy.setCookie('token1','jwt1')//æ·»åŠ cookie name:value
cy.setCookie('token2','jwt2')
cy.getCookie('token1').should('have.property','value','jwt1')

cy.getCookies()//è·å–æµè§ˆå™¨å…¨éƒ¨cookies
.should((cookies)=>{
    expect(cookies[0]).to.have.property('value','jwt1')
    expect(cookies[1]).to.have.property('value','jwt2')
})
cy.clearCookie('token1') //æ ¹æ®nameåç§°åˆ é™¤æŒ‡å®šcookies

cy.getCookie('token1').should('be.null')
cy.clearCookies() //æ¸…ç©ºå…¨éƒ¨cookie
```

## å¤šä¸ªç”¨ä¾‹ä¹‹é—´ä¿ç•™cookie

Cypressä¼šåœ¨æ¯ä¸ªtestè¿è¡Œå‰è‡ªåŠ¨çš„æ¸…æ‰æ‰€æœ‰çš„cookieã€‚å¯ä»¥ç”¨ preserveOnce() æ¥åœ¨å¤šä¸ªtestä¹‹é—´ä¿ç•™cookieï¼Œè¿™åœ¨æœ‰ç™»å½•è¦æ±‚çš„è‡ªåŠ¨åŒ–æµ‹è¯•æ–¹é¢æ›´æ–¹ä¾¿ã€‚

```.bash
Cypress.Cookies.preserveOnce('key name1', 'key name2')

æ —å­ï¼š
describe('ç™»å½•å-è®¿é—®é¦–é¡µ', function() {
    before(() => {
          cy.login("admin", "****123456")
        })

    beforeEach(function () {
        Cypress.Cookies.preserveOnce('zentaosid', 'csrftoken')
      })

    it("è®¿é—®é¦–é¡µ", () =>
        {
            cy.visit("http://ip:8080/zentao/my/")
            cy.url().should('include', '/zentao/my/')
            cy.title().should('contain', 'æˆ‘çš„åœ°ç›˜ - ç¦…é“')
        })

    it("è®¿é—®åå°ç®¡ç†", () =>
        {
            cy.visit("http://ip:8080/zentao/admin/")
            cy.url().should('include', '/zentao/admin/')
            cy.title().should('contain', 'åå°ç®¡ç† - ç¦…é“')
        })

    })

```

## cookieæ·»åŠ ç™½åå•

å…ˆåœ¨ cypress/support/index.js æ–‡ä»¶ä¸­æ·»åŠ  cookie ç™½åå•ï¼Œè¿™ä¸ªindex.jsæ–‡ä»¶ä¼šåœ¨æµ‹è¯•ç”¨ä¾‹æ‰§è¡Œä¹‹å‰åŠ è½½

```.bash
Cypress.Cookies.defaults({
  whitelist: ['zentaosid', 'csrftoken']
})

è¿™æ ·å°±é¿å…äº†æ¯ä¸ªjsæ–‡ä»¶éƒ½åœ¨beforeEach() åŠ ä¸€æ¬¡ Cypress.Cookies.preserveOnce('zentaosid', 'csrftoken')
å¾ˆæ˜¾ç„¶è¿™ç§ç™½åå•çš„æ–¹å¼æ›´ä¼˜é›…ä¸€ç‚¹

```
